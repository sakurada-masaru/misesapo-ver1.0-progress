<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>登録情報確認（個人・店舗） | ミセサポ</title>
    <link rel="stylesheet" href="/styles.css" />
<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<!-- 
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet" />
-->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
<style>
  body { font-family: 'Noto Sans JP', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif; }
  /* Brand theme variables (default + variants) */
  body { --primary: #FF679C; --primary-600: #E35687; }
  body.theme-pink { --primary: #FF679C; --primary-600: #E35687; }
  body.theme-blue { --primary: #2563eb; --primary-600: #1d4ed8; }
  body.theme-emerald { --primary: #10b981; --primary-600: #059669; }
  /* Note: :root also defines the same brand color; inline vars ensure early paint */
  </style>

  </head>
  <body class="theme-pink registration bg-white">
    <main class="container">
      <div class="text-center reg-logo-block">
        <img src="/images/logo_144x144.png" alt="ミセサポ" class="reg-logo" />
        <div class="small caption-strong">新規登録</div>
      </div>
      <div class="hr"></div>

      <!-- Steps (personal 2-step) -->
      <div class="steps">
        <div class="step"><div class="dot">1</div><div>店舗情報登録</div></div>
        <div class="step active"><div class="dot">2</div><div>登録情報確認</div></div>
      </div>

      <p class="warn">内容に間違いがないかご確認ください。</p>

<section id="confirm" class="stack lg confirm-section"></section>

<script>
  (function(){
    const params = new URLSearchParams(location.search);
    const out = document.getElementById('confirm');

    // group all stores[*] by index
    const storeMap = new Map();
    for (const [k,v] of params.entries()){
      const m = k.match(/^stores\[(\d+)\]\[(.+)\]$/);
      if (!m) continue;
      const idx = m[1];
      const field = m[2];
      if (!storeMap.has(idx)) storeMap.set(idx, {});
      storeMap.get(idx)[field] = v;
    }

    function locked(label, text){
      const ph = text && String(text).trim() ? String(text) : '—';
      return `<div class="group">`+
               `<label class="label">${label}</label>`+
               `<input class="input input-locked" placeholder="${ph.replace(/"/g,'&quot;')}" disabled />`+
             `</div>`;
    }

    let html = '';
    storeMap.forEach((s, idx) => {
      html += `<h3 class=\"section-title\" style=\"margin:8px 0 6px;\">店舗 ${idx}</h3>`;
      html += locked('店舗名', s['store-name']);
      html += locked('店舗カナ', s['store-kana']);
      html += locked('電話番号', s['phone']);
      html += locked('担当者名', s['contact-person']);
      html += locked('統括管理責任者', s['general-manager']);
      html += locked('衛生管理責任者', s['hygiene-manager']);
      html += locked('防火管理責任者', s['fire-manager']);
      html += locked('食品衛生責任者', s['food-sanitation-manager']);
      html += locked('郵便番号', ((s['postal-code1']||'') + (s['postal-code2']? '-' + s['postal-code2'] : '')).trim());
      html += locked('住所', s['address']);
      html += locked('建物名', s['building-name']);
      html += locked('店舗メール', s['store-email']);
      html += locked('営業時間', s['business-hours']);
      html += locked('定休日', s['holidays']);
      html += locked('清掃可能時間', s['cleaning-time']);
      html += locked('業態', s['business-category']);
      html += locked('築年数', s['building-age']);
      html += locked('営業年数', s['business-years']);
      html += locked('店舗の広さ', s['store-size']);
      html += locked('天井の高さ', s['ceiling-height']);
      html += locked('シンク有無', s['sink-available']);
      html += locked('駐車場', s['parking']);
      html += locked('鍵の受け渡し', s['key-handover']);
      html += locked('鍵の詳細', s['key-details']);
      html += locked('通知', s['notifications']);
      html += locked('メールマガジン', s['newsletter']);
      html += `<div class=\"hr\"></div>`;
    });

    if (html === '') html = '<p class="small">店舗データが見つかりませんでした。</p>';
    out.innerHTML = html;

    function bindFinalSubmit(){
      const btn = document.getElementById('final-submit');
      if (!btn) return;
      btn.addEventListener('click', function(){
        // 実装時はPOST送信。モックでは完了ページに遷移。
        location.href = '/registration/complete.html';
      });
    }
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', bindFinalSubmit);
    } else {
      bindFinalSubmit();
    }
  })();
</script>


      <div class="actions actions-y-md">
        <a class="btn btn-outline-primary btn-fixed btn-round" href="/registration/personal.html">修正する</a>
        <button id="final-submit" class="btn btn-primary btn-fixed btn-round">登録</button>
      </div>
    </main>
  </body>
  </html>
